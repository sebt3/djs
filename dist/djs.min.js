(function(global,factory){if(typeof global.d3!=="object"||typeof global.d3.version!=="string")throw new Error("tables requires d3v4");var v=global.d3.version.split(".");if(v[0]!="4")throw new Error("tables requires d3v4");factory(global.slides=global.slides||{},d3,global)})(this,function(slides,d3,global){var all_slides=[];var nav={};var events={};var speaker={};nav.read=function(){if(window.location.hash.length==0)return 0;var id=Number.parseInt(window.location.hash.substring(1));if(Number.isNaN(id))return 0;return id};nav.write=function(id){window.location.hash=id};nav.current=nav.read();nav.render=function(id){if(id<0)id=0;if(id>=all_slides.nodes().length)id=all_slides.nodes().length-1;if(nav.current==id)return null;d3.select(all_slides.nodes()[nav.current]).classed("out",true);d3.select(all_slides.nodes()[id]).classed("out",false);speaker.nav(id);nav.current=id;nav.write(id)};nav.prev=function(m){if(typeof m==="undefined")m=1;nav.render(nav.current-m)};nav.next=function(m){if(typeof m==="undefined")m=1;nav.render(nav.current+m)};events.keydown=function(){switch(d3.event.keyCode){case 8:case 37:case 38:case 109:nav.prev();break;case 13:case 32:case 39:case 40:case 107:nav.next();break;case 83:speaker.start();break}};events.wheel=function(){if(d3.event.wheelDelta<0)nav.next();else if(d3.event.wheelDelta>0)nav.prev()};events.slide={};events.slide.x=0;function unify(e){return e.changedTouches?e.changedTouches[0]:e}events.slide.start=function(){events.slide.x=unify(d3.event).clientX};events.slide.end=function(){if(events.slide.x===0)return;var dx=unify(d3.event).clientX-events.slide.x;events.slide.x=0;nav.render(nav.current-Math.sign(dx))};speaker.nav=function(id){if("w"in speaker===false)return;if(speaker.w.closed)return;speaker.slides_cur.classed("out",true);speaker.slides_next.classed("out",true);d3.select(speaker.slides_cur.nodes()[id]).classed("out",false);if(id<all_slides.nodes().length)d3.select(speaker.slides_next.nodes()[id+1]).classed("out",false);speaker.notes.html("");var notes=d3.select(all_slides.nodes()[id]).select(".notes");if(!notes.empty())speaker.notes.node().insertBefore(notes.node().cloneNode(true),undefined)};speaker.start=function(){if("w"in speaker&&!speaker.w.closed){speaker.w.moveBy(0,0);speaker.w.focus();return}speaker.w=window.open("","_blank","toolbar=0,location=0,menubar=0");speaker.w.document.write('<html><head><title>speaker view</title><style>.column{margin:0 0;padding:10px 10px;float:left;width:50%; height:100%;box-sizing: border-box;} iframe{width:190%;height:90%;box-sizing: border-box;margin: 2% 2%;transform-origin: 0 0;transform: scale(0.50);margin-bottom:-45%;} .right .control{border-bottom:1px solid black;} button{margin:5px 5px;}</style></head><body><div class="column left"><iframe class="current"></iframe><iframe class="next"></iframe></div><div class="column right"><div class="control"></div><div class="notes"></div></div></body></html>');speaker.frame_cur=d3.select(speaker.w.document).select(".current");speaker.frame_next=d3.select(speaker.w.document).select(".next");speaker.control=d3.select(speaker.w.document).select(".control");speaker.notes=d3.select(speaker.w.document).select(".notes");speaker.current=d3.select(speaker.frame_cur.node().contentDocument);speaker.next=d3.select(speaker.frame_next.node().contentDocument);var tb=speaker.control.append("div");tb.append("button").attr("type","button").html("&laquo;").on("click",function(){nav.prev(5)});tb.append("button").attr("type","button").html("&lsaquo;").on("click",nav.prev);tb.append("button").attr("type","button").html("&rsaquo;").on("click",nav.next);tb.append("button").attr("type","button").html("&raquo;").on("click",function(){nav.next(5)});var s=tb.append("select").attr("id","select").on("change",function(){nav.render(tb.select("#select").property("value")-1)});all_slides.each(function(i){var t;var me=d3.select(this).select(".title");if(!me.select("h1").empty())t=me.select("h1").text();else if(d3.select(this).classed("first")&&!d3.select(this).select("h1").empty())t=d3.select(this).select("h1").text();else t="slide "+i;if(!me.select("h2").empty())t+=" - "+me.select("h2").text();s.append("option").attr("value",i).text(t)});for(var i=0,len=document.styleSheets.length;i<len;i++){if(document.styleSheets[i].href!=null){speaker.current.select("head").append("link").attr("rel","stylesheet").attr("href",document.styleSheets[i].href);speaker.next.select("head").append("link").attr("rel","stylesheet").attr("href",document.styleSheets[i].href)}}d3.select("head").selectAll("style").nodes().forEach(function(s){speaker.current.select("head").node().insertBefore(s.cloneNode(true),undefined);speaker.next.select("head").node().insertBefore(s.cloneNode(true),undefined)});speaker.current.select("body").append("div").classed("jslides",true).append("div").classed("slides",true).node().insertBefore(d3.select(".jslides .slides").node().cloneNode(true),undefined);speaker.next.select("body").append("div").classed("jslides",true).append("div").classed("slides",true).node().insertBefore(d3.select(".jslides .slides").node().cloneNode(true),undefined);speaker.slides_cur=speaker.current.select(".jslides .slides").selectAll("section");speaker.slides_next=speaker.next.select(".jslides .slides").selectAll("section");speaker.nav(nav.current)};d3.select(window).on("load.jslides",function(){var footer=d3.select(".jslides .footer footer");all_slides=d3.select(".jslides .slides").selectAll("section");all_slides.classed("out",true);d3.select(all_slides.nodes()[nav.current]).classed("out",false);var bar=d3.select("body").append("div").classed("nav_buttons",true);bar.append("div").classed("grow",true).html("&lsaquo;").on("click",nav.prev);bar.append("div").classed("grow",true).html("&rsaquo;").on("click",nav.next);all_slides.each(function(d,t){var me=d3.select(this).datum(t+1);if(!me.classed("first")){if(me.select(".title").empty()){me.insert("div",":first-child").classed("title",true)}me.select(".title").append("span").classed("num",true).text(t+1+"/"+all_slides.nodes().length)}if(!footer.empty())me.node().insertBefore(footer.node().cloneNode(true),undefined)});d3.select(".jslides .slides").selectAll("section.index").each(function(d,t){var ol=d3.select(this).append("div").classed("content",true).append("ol");var li;var prev="";var sub="";var have_child=false;all_slides.each(function(i){var t1,t2="";if(i<=d)return;var me=d3.select(this).select(".title");if(me.select("h1").empty())return;t1=me.select("h1").text();if(!me.select("h2").empty())t2=me.select("h2").text();if(t1!=prev){have_child=false;prev=t1;sub=t2;li=ol.append("li").attr("value",i).text(t1)}else if(have_child&&t2!=""){li.select("ol").append("li").attr("value",i).text(t2)}else if(!have_child&&t2!=""&&sub!=""){have_child=true;var o=li.append("ol");o.append("li").attr("value",li.attr("value")).text(sub);o.append("li").attr("value",i).text(t2)}});if(ol.selectAll("li").nodes().length>40){ol.selectAll("ol").remove()}var th=window.innerHeight-d3.select(this).select("div.title").node().getBoundingClientRect().height;var h=ol.node().getBoundingClientRect().height;if(h>th){ol.style("transform-origin","top");ol.style("transform","scale("+.9*th/h+")")}});d3.select(window).on("wheel.jslides",events.wheel,{passive:true}).on("keydown.jslides",events.keydown).on("touchstart.jslides",events.slide.start).on("touchend.jslides",events.slide.end).on("mousedown.jslides",events.slide.start).on("mouseup.jslides",events.slide.end)});if(typeof global.hljs==="object")hljs.initHighlightingOnLoad()});
